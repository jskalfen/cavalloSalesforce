<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>59.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Closed_Lost_Date</name>
        <label>Closed Lost Date</label>
        <locationX>1634</locationX>
        <locationY>911</locationY>
        <assignmentItems>
            <assignToReference>$Record.Closed_Lost_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.CloseDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Closed_Won</name>
        <label>Closed Won</label>
        <locationX>1370</locationX>
        <locationY>911</locationY>
        <assignmentItems>
            <assignToReference>$Record.Closed_Won_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.CloseDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Contract_Negotiation_Date</name>
        <label>Contract Negotiation Date</label>
        <locationX>1106</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Contract_Negotiation_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Demo_Techincal_Evaluation_Date</name>
        <label>Demo/Techincal Evaluation Date</label>
        <locationX>578</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Demo_Technical_Evaluation_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Discovery_Date</name>
        <label>Discovery Date</label>
        <locationX>50</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Discovery_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Est_Value_Net_ARR</name>
        <label>Est Value = Net ARR</label>
        <locationX>974</locationX>
        <locationY>1511</locationY>
        <assignmentItems>
            <assignToReference>$Record.Estimated_Value__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Net_ARR_Opp__c</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Est_Value_Uplift_ARR</name>
        <label>Est Value = Uplift ARR</label>
        <locationX>710</locationX>
        <locationY>1511</locationY>
        <assignmentItems>
            <assignToReference>$Record.Uplift_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>UpliftARR</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Estimated_Value__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>UpliftARR</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Estimated_Value_0</name>
        <label>Estimated Value = 0</label>
        <locationX>1392</locationX>
        <locationY>395</locationY>
        <assignmentItems>
            <assignToReference>$Record.Estimated_Value__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Record_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Probability_custom_0</name>
        <label>Probability % (custom) = 0</label>
        <locationX>1634</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Probability_custom__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Closed_Lost_Date</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Probability_custom_100</name>
        <label>Probability % (custom) = 100</label>
        <locationX>1370</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Probability_custom__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>100</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Closed_Won</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Proposal_Date</name>
        <label>Proposal Date</label>
        <locationX>842</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Proposal_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Qualified_Date</name>
        <label>Qualified Date</label>
        <locationX>314</locationX>
        <locationY>803</locationY>
        <assignmentItems>
            <assignToReference>$Record.Qualified_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Reseller_VAR_20</name>
        <label>Reseller/VAR = 20%</label>
        <locationX>1106</locationX>
        <locationY>1211</locationY>
        <assignmentItems>
            <assignToReference>$Record.Reseller_VAR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>20</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Est_Value</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Reseller_VAR_30</name>
        <label>Reseller/VAR = 30%</label>
        <locationX>842</locationX>
        <locationY>1211</locationY>
        <assignmentItems>
            <assignToReference>$Record.Reseller_VAR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>30</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Est_Value</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Reseller_VAR_40</name>
        <label>Reseller/VAR = 40%</label>
        <locationX>578</locationX>
        <locationY>1211</locationY>
        <assignmentItems>
            <assignToReference>$Record.Reseller_VAR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>40</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Est_Value</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Opp_Type</name>
        <label>Type?</label>
        <locationX>1524</locationX>
        <locationY>287</locationY>
        <defaultConnector>
            <targetReference>Record_Type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Expansion_Services_only</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Expansion - Services only</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Estimated_Value_0</targetReference>
            </connector>
            <label>Expansion - Services only</label>
        </rules>
    </decisions>
    <decisions>
        <name>Partner_for_Margin_Partner_Level</name>
        <label>Partner for Margin &gt; Partner Level</label>
        <locationX>974</locationX>
        <locationY>1103</locationY>
        <defaultConnector>
            <targetReference>Update_Est_Value</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Gold_Plus</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Partner__r.Partner_Level__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Gold Plus</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Reseller_VAR_40</targetReference>
            </connector>
            <label>Gold Plus</label>
        </rules>
        <rules>
            <name>Gold</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Partner__r.Partner_Level__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Gold</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Reseller_VAR_30</targetReference>
            </connector>
            <label>Gold</label>
        </rules>
        <rules>
            <name>Silver</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Partner__r.Partner_Level__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Silver</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Reseller_VAR_20</targetReference>
            </connector>
            <label>Silver</label>
        </rules>
    </decisions>
    <decisions>
        <name>Record_Type</name>
        <label>Record Type</label>
        <locationX>1524</locationX>
        <locationY>587</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>New_Business</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New Business</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Stage_Updated</targetReference>
            </connector>
            <label>New Business</label>
        </rules>
    </decisions>
    <decisions>
        <name>Stage_Updated</name>
        <label>Stage Updated?</label>
        <locationX>974</locationX>
        <locationY>695</locationY>
        <defaultConnector>
            <targetReference>Partner_for_Margin_Partner_Level</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Discovery</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Discovery</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Discovery_Date</targetReference>
            </connector>
            <label>Discovery</label>
        </rules>
        <rules>
            <name>Qualified</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Qualified</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Qualified_Date</targetReference>
            </connector>
            <label>Qualified</label>
        </rules>
        <rules>
            <name>Demo_Technical_Evaluation_Stage_Updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Demo/Technical Evaluation</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Demo_Techincal_Evaluation_Date</targetReference>
            </connector>
            <label>Demo/Technical Evaluation</label>
        </rules>
        <rules>
            <name>Proposal_Stage_Updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Proposal</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Proposal_Date</targetReference>
            </connector>
            <label>Proposal</label>
        </rules>
        <rules>
            <name>ContractNegotiation_Stage_Updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Contract Negotiation</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Contract_Negotiation_Date</targetReference>
            </connector>
            <label>Contract Negotiation</label>
        </rules>
        <rules>
            <name>Closed_Won_Stage_Updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed Won</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Probability_custom_100</targetReference>
            </connector>
            <label>Closed Won</label>
        </rules>
        <rules>
            <name>Closed_Lost</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed Lost</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Probability_custom_0</targetReference>
            </connector>
            <label>Closed Lost</label>
        </rules>
    </decisions>
    <decisions>
        <name>Update_Est_Value</name>
        <label>Update Est Value?</label>
        <locationX>974</locationX>
        <locationY>1403</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_with_Uplift</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Expansion - Early renewal with growth</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Net_ARR_Opp__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Net_ARR_Opp__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Net_ARR_Opp__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Est_Value_Uplift_ARR</targetReference>
            </connector>
            <label>Yes, with Uplift</label>
        </rules>
        <rules>
            <name>Yes_with_Net_ARR</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Net_ARR_Opp__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Net_ARR_Opp__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Net_ARR_Opp__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Est_Value_Net_ARR</targetReference>
            </connector>
            <label>Yes, with Net ARR</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>UpliftARR</name>
        <dataType>Currency</dataType>
        <expression>{!$Record.Net_ARR_Opp__c} - ({!$Record.Account.MRR_ROLL_UP__c} * 12)</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>Opportunity: Before Update {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Opportunity: Before Update</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <start>
        <locationX>1398</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Opp_Type</targetReference>
        </connector>
        <object>Opportunity</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
